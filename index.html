<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>What constrains food webs? A maximum entropy framework for predicting their structure with minimal biases</title>
    <script src="https://hypothes.is/embed.js" async></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,500;1,400;1,500&display=swap');

        :root {
            --citation: #1976D2;
            --structure: hsl(210, 61%, 43%);
            
            --light: #474747;
            --pale: #a5a5a5;
            --grey: #e0e0e0;
            --nav: #fdfdfd;

            --width: 820px;
            --inner-space: 1.2em;
        }

        body {
            font-family: "Roboto", sans-serif;
            margin: 0 0;
            padding: 0 0;
        }

        article > p {
            line-height: 135%;
        }
        article > h1 {
            padding-top: 3em;
        }
        a {
            text-decoration: none;
            color: #000;
            border-bottom: 1px solid var(--structure);
        }
        a:hover {
            font-weight: 500;
        }
        .citation {
            color: var(--citation);
        }
        .container {
            margin: 0em auto;
            max-width: var(--width);
            padding: var(--inner-space);
        }
        header > .container {
            margin-top: 4em;
        }
        code, pre {
            font-family: "Roboto Mono", monospace;
        }
        pre {
            white-space: pre-wrap;
        }
        h1, h2, h3 {
            color: var(--structure);
            font-family: "Roboto Condensed", sans-serif;
            font-weight: 400;
        }
        header {
            font-family: "Roboto Condensed", sans-serif;
            z-index: 5;
            color: black;
            margin-top: 4rem;
        }
        .header--title {
            font-weight: 400;
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .header--authors > span {
            color: var(--light);
            font-weight: 400;
        }
        main {
            padding-top: 8em !important;
            padding-bottom: 8em !important;
        }
        footer {
            background-color: var(--grey);
            font-weight: 300;
        }
        .abstract {
            color: var(--light);
            margin-bottom: 5em;
        }
        figure {
            max-width: 100%;
            border: 1px solid var(--pale);
            border-radius: 2px;
            margin: 1em 0.5em;
        }
        figure > img {
            max-width: 100%;
            display: block;
            margin: 0em auto;
        }
        figure > figcaption {
            padding: var(--inner-space);
        }
        table {
            width: 100%;
            min-width: 100%;
            border-collapse: collapse;
        }
        table > caption {
            padding: var(--inner-space);
        }
        figcaption, caption {
            color: var(--light);
            font-weight: 300;
        }
        thead {
            color: var(--structure);
        }
        td, th {
            padding: 3px;
        }
        tr {
            border-top: 1px solid var(--structure);
            border-bottom: 1px solid var(--structure);
        }
        tbody > tr:nth-child(even) {background: var(--grey)};
        tbody {
            border-bottom: 1px solid var(--structure);
        }
        #refs {
            font-size: 90%;
            column-count: 2;
        }
        #refs > .csl-entry {
            padding-bottom: 0.2em;
            padding-top: 0.2em;
        }
        .hanging-indent > .csl-entry {
            padding-left: 15px ;
            text-indent: -15px ;
        }    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css"
    integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous" />
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js"
    integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O"
    crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js"
    integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF"
    crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(document.body, {
                delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false }
                ]
            });
        });
    </script>
</head>

<body>
    <header>
        <div class="container">
            <div class="header--title">What constrains food webs? A maximum entropy framework for predicting their structure with minimal biases</div>
            <div class="header--authors">
                                <span class="header--author">
                                        <a href="https://orcid.org/0000-0001-9051-0597" target="_blank">
                        Francis Banville
                    </a>
                                                                <sup class="affilcode">1</sup>
                                            <sup class="affilcode">2</sup>
                                            <sup class="affilcode">3</sup>
                                    </span>
                                <span class="header--author">
                                        <a href="https://orcid.org/0000-0002-4498-7076" target="_blank">
                        Dominique Gravel
                    </a>
                                                                <sup class="affilcode">2</sup>
                                            <sup class="affilcode">3</sup>
                                    </span>
                                <span class="header--author">
                                        <a href="https://orcid.org/0000-0002-0735-5184" target="_blank">
                        Timothée Poisot
                    </a>
                                                                <sup class="affilcode">1</sup>
                                            <sup class="affilcode">3</sup>
                                    </span>
                            </div>
        </div>
    </header>
    
    <main class="container">
        <section class="abstract">
            <b>Abstract:</b> Food webs are complex ecological networks whose structure is both ecologically and statistically constrained, with many network properties being correlated with each other. Despite the recognition of these invariable relationships in food webs, the use of the principle of maximum entropy (MaxEnt) in network ecology is still rare. This is surprising considering that MaxEnt is a renowned and rigorous statistical tool precisely designed for understanding and predicting many different types of constrained systems. Precisely, this principle asserts that the least-biased probability distribution of a system’s property, constrained by prior knowledge about that system, is the one with maximum information entropy. MaxEnt has been proven useful in many ecological modelling problems, but its application in food webs and other ecological networks is limited. Here we show how MaxEnt can be used to derive many food-web properties both analytically and heuristically. First, we show how the joint degree distribution (the joint probability distribution of the numbers of prey and predators for each species in the network) can be derived analytically using the number of species and the number of interactions in food webs. Second, we present a heuristic and flexible approach of finding a network’s adjacency matrix (the network’s representation in matrix format) based on simulated annealing and SVD entropy. We built two heuristic models using the connectance and the joint degree sequence as statistical constraints, respectively. We compared both models’ predictions against corresponding null and neutral models commonly used in network ecology using open access data of terrestrial and aquatic food webs sampled globally (N = 257). We found that the heuristic model constrained by the joint degree sequence was a good predictor of many measures of food-web structure, especially the nestedness and motifs distribution. Specifically, our results suggest that the structure of terrestrial and aquatic food webs is mainly driven by their joint degree distribution.<br />
            <div class="artifacts">
                <a href="draft.pdf" title="Draft PDF" target="_blank">draft</a>
                <a href="preprint.pdf" title="Preprint PDF" target="_blank">preprint</a>
                <a href="suppmat.pdf" title="SuppMat PDF" target="_blank">suppmat</a>
            </div>
        </section>
        
        <article>
            <h1 id="introduction">Introduction</h1>
            <h2 id="the-constrained-structure-of-ecological-networks">The constrained structure of ecological networks</h2>
            <p>A variety of measures of the structure of ecological networks have been used to describe the organization of species interactions in a biological community <span class="citation" data-cites="Delmas2019AnaEco">(Delmas et al. 2019)</span>. These measures provide valuable information on the functioning of ecosystems and their responses to environmental change <span class="citation" data-cites="Pascual2006EcoNeta Gomez2011FunConb">(e.g., Pascual and Dunne 2006; Gómez, Perfectti, and Jordano 2011)</span>. For instance, <span class="citation" data-cites="Bascompte2003NesAssa">Bascompte et al. (2003)</span> suggest that plant–pollinator and seed-disperser networks have a highly nested structure that can promote species persistence. Another example, in food webs, shows that a high connectance can promote the robustness of the system to species lost <span class="citation" data-cites="Dunne2002NetStrb">(Dunne, Williams, and Martinez 2002)</span>. However, despite the growing literature on the ecological implications of network structure, the association between many of these measures impedes our ability to fully understand what drives the structure and behavior of ecological networks. In particular, nestedness and modularity are strongly associated in ecological networks <span class="citation" data-cites="Fortuna2010NesMod">(Fortuna et al. 2010)</span>, and network connectance has been shown to be an important driver of many other emerging network properties <span class="citation" data-cites="Poisot2014WheEcoa">(Timothée Poisot and Gravel 2014)</span>. In light of these observations, it is difficult to assess whether attributed effects of given properties are the artifacts of other, perhaps simpler, measures. It might be necessary to factor out the effect of other correlated measures before analyzing the structure of ecological networks.</p>
            <p>One way to tackle this issue is first to recognize that food webs and other ecological networks are constrained systems. In other words, the space of possible network configurations shrinks as we know more about a network structure. Consequently, the range of values that a given network property can take depends on the values of other properties. Above all, the structure of ecological networks is constrained by the number of species, or nodes, present. Food webs with high species richness typically have a lower connectance <span class="citation" data-cites="MacDonald2020RevLin">(MacDonald, Banville, and Poisot 2020)</span> than smaller networks. This is because the number of realized interactions in empirical food webs scales slower than the number of possible species pairs <span class="citation" data-cites="MacDonald2020RevLin">(MacDonald, Banville, and Poisot 2020)</span>. As shown by <span class="citation" data-cites="Poisot2014WheEcoa">Timothée Poisot and Gravel (2014)</span>, connectance itself can constrain different aspects of network structure such as the degree distribution. Other measures, such as the maximum trophic level, can also constrain the space of feasible networks.</p>
            <p>Statistical and mathematical models can help fill many gaps in our knowledge about species interactions. Predictive and null models are two complementary types of models that have been developed in network ecology for this purpose. On one hand, predictive models can partially alleviate the Eltonian shortfall, which describes our current lack of knowledge on food webs and other ecological networks <span class="citation" data-cites="Hortal2015SevSho">(Hortal et al. 2015)</span>. A variety of such models have recently been developed using machine learning and other statistical tools, most of which are presented in <span class="citation" data-cites="Strydom2021RoaPre">Strydom et al. (2021)</span>. On the other hand, null models help us identify potential ecological mechanisms that drive species interactions. They do so by comparing empirical data with an unbiased distribution of measures generated using a set of rules that exclude the mechanism of interest <span class="citation" data-cites="Fortuna2006HabLos Delmas2019AnaEco">(Fortuna and Bascompte 2006; Delmas et al. 2019)</span>. Both types of models are frequently topological, i.e. they often predict the adjacency matrix or specific measures of network structure without taking into account species’ identity. According to <span class="citation" data-cites="Strydom2021RoaPre">Strydom et al. (2021)</span>, these topological models could be used to make better predictions of pairwise species interactions by constraining the space of feasible networks.</p>
            <h2 id="the-principle-of-maximum-entropy-a-primer-for-ecologists">The principle of maximum entropy: A primer for ecologists</h2>
            <p>The principle of maximum entropy (MaxEnt) is a statistical and topological model that can be used for both of these purposes, i.e. to make predictions of network structure and to better understand processes shaping ecological networks. Food-web properties that can be derived using MaxEnt are varied and pertain to different elements of the network (i.e. at the species (node), the interaction (edge) or the community (network) levels). Because MaxEnt is a method of finding probability distributions that are least biased given partial knowledge about a system, these properties need to be represented probabilistically. Otherwise, some data transformation might be needed. For example, at the species level, MaxEnt can be used to predict the distribution of trophic levels among species, as well as the distribution of species’ vulnerability (number of predators) and generality (number of preys). By contrast, at the interaction level, predictions can be made on the distribution of interaction strengths in weighted food webs. At the community level, it can give us a probability distribution of potential networks or of specific measures of their emerging structure. The applicability and performance of this method depend on the ecological information available and on our capacity to find the set of state variables that best represent natural systems and to translate them into appropriate statistical constraints. MaxEnt has been used in a wide range of disciplines, from thermodynamics to chemistry and biology <span class="citation" data-cites="Martyushev2006MaxEnt">(Martyushev and Seleznev 2006)</span>. It has also been proven useful in ecology, e.g. in species distribution models <span class="citation" data-cites="Phillips2006MaxEnta">(Phillips, Anderson, and Schapire 2006)</span> and macroecological models <span class="citation" data-cites="Harte2008MaxEnt Harte2014MaxInf">(Harte et al. 2008; Harte and Newman 2014)</span>. The probability distribution of the variable of interest with the maximum entropy value is unique and least biased under the set of constraints used. These constraints are built using state variables, i.e. variables that represent the macrostate of the system. Having a validated maximum entropy model for the system at hand allows us to make rigorous predictions using a minimal amount of data, as well as helping us describe the most important factors driving that system.</p>
            <p>The principle of maximum entropy is a mathematical method of finding probability distributions, strongly rooted in statistical mechanics and information theory <span class="citation" data-cites="Jaynes1957InfThe Jaynes1957InfThea Harremoes2001MaxEnt">(Jaynes 1957a, 1957b; Harremoës and Topsøe 2001)</span>. Starting from a set of constraints given by prior knowledge of a system (i.e. what we call state variables), this method helps us find least-biased probability distributions subject to the constraints. These probability distributions are guaranteed to be unique given our prior knowledge and represent the most we can say about a system without making more assumptions. For example, if the only thing we know about a biological community is its average number of individuals per species, the least-biased inference we could make on its species abundance distribution is the exponential distribution <span class="citation" data-cites="Frank2011SimDera Harte2014MaxInf">(Frank and Smith 2011; Harte and Newman 2014)</span>. However, this does not imply that this distribution will be the best fit to empirical data. The challenge is to find the right set of constraints that would best reproduce distributions found in nature.</p>
            <p>The least-biased probability distribution given the constraints used is the one with the highest entropy among all probability distributions that satisfy these constraints. Entropy is a measure of the average amount of information given by the outcome of a random variable. Many measures of entropy have been developed in physics <span class="citation" data-cites="Beck2009GenInf">(Beck 2009)</span>, but only a fraction of them could be used as an optimization measure with the principle of maximum entropy. According to <span class="citation" data-cites="Beck2009GenInf">Beck (2009)</span> and <span class="citation" data-cites="Khinchin2013MatFou">Khinchin (2013)</span>, a measure of entropy <span class="math inline"><em>H</em></span> should satisfy four properties in the discrete case: (1) it should be a function of a probability distribution <span class="math inline"><em>p</em>(<em>n</em>)</span> only; (2) it should be maximized when <span class="math inline"><em>p</em>(<em>n</em>)</span> is uniform; (3) it should not be influenced by outcomes with a null probability; and (4) it should be independent of the order of information acquisition. The Shannon’s entropy <span class="citation" data-cites="Shannon1948MatThe">(Shannon 1948)</span></p>
            <p><span id="eq:shannon"><span class="math display"><em>H</em> =  − ∑<sub><em>n</em></sub><em>p</em>(<em>n</em>)log <em>p</em>(<em>n</em>)   (1)</span></span></p>
            <p>satisfies all of these properties. Finding the probability distribution <span class="math inline"><em>p</em>(<em>n</em>)</span> that maximizes <span class="math inline"><em>H</em></span> under a set of <span class="math inline"><em>m</em></span> constraints <span class="math inline"><em>g</em></span> can be done using the method of Lagrange multipliers. These constraints could include one or many properties of the probability distribution (e.g., its mean, variance, and range). However, the normalization constraint always need to be included in <span class="math inline"><em>g</em></span> in order to make sure that <span class="math inline"><em>p</em>(<em>n</em>)</span> sums to <span class="math inline">1</span>. The objective is then to find the values of the Lagrange multipliers <span class="math inline"><em>λ</em><sub><em>i</em></sub></span> that optimize a function <span class="math inline"><em>F</em></span>:</p>
            <p><span id="eq:F"><span class="math display">$$F = H - \sum_{i=1}^m \lambda_i (g_i-c_i),\qquad(2)$$</span></span></p>
            <p>where <span class="math inline"><em>g</em><sub><em>i</em></sub></span> is the mathematical formulation of the constraint <span class="math inline"><em>i</em></span> and <span class="math inline"><em>c</em><sub><em>i</em></sub></span>, its value. Note that <span class="math inline"><em>F</em></span> is just Shannon’s entropy to which we added terms that each sums to zero (<span class="math inline"><em>g</em><sub><em>i</em></sub> = <em>c</em><sub><em>i</em></sub></span>). <span class="math inline"><em>F</em></span> is maximized by setting to <span class="math inline">0</span> its partial derivative with respect to <span class="math inline"><em>p</em>(<em>n</em>)</span>. In this contribution, we show how this can be done by deriving the joint degree distribution analytically from the number of species and the number of interactions in food webs.</p>
            <h2 id="objectives">Objectives</h2>
            <p>Despite its extensive use in graph and network theories <span class="citation" data-cites="Park2004StaMeca vanderHoorn2018SpaMaxa">(e.g., Park and Newman 2004; van der Hoorn, Lippner, and Krioukov 2018)</span>, MaxEnt has in comparison been little used in network ecology. Like other real system networks, food webs and other ecological networks are represented mathematically as graphs. However, the very nature of food webs (directed simple graphs frequently having self-loops) makes the mathematical optimization of maximum entropy graph models more complicated than with many other types of (non-ecological) networks. MaxEnt has nevertheless been used to predict the degree distribution of bipartite ecological networks from the number of species and the number of interactions <span class="citation" data-cites="Williams2011BioMet">(Williams 2011)</span> and to predict interaction strengths between species pairs using their relative abundances within an optimal transportation theory regularized with information entropy <span class="citation" data-cites="Stock2021OptTra">(Stock, Poisot, and De Baets 2021)</span>. However, to the best of our knowledge, MaxEnt has never been used to predict food-web structure directly, even though food webs are among the most documented and widespread ecological networks.</p>
            <p>In this contribution, we used two complementary approaches to predict the structure of food webs using the principle of maximum entropy. We then compared our predictions against empirical data and null and neutral models commonly used in network ecology. The first approach consists in deriving constrained probability distributions of given network properties directly. We derived the joint degree distribution (the joint probability distribution that a species has a given number of prey and predators in a food web) of maximum entropy using only the number of species <span class="math inline"><em>S</em></span> and the number of interactions <span class="math inline"><em>L</em></span> as state variables. Then, we predicted the degree distribution of maximum entropy directly from the joint degree distribution since the first is the sum of the marginal distributions of the second (a species’ degree is the sum of its in and out-degrees). Because of the scarcity of empirical data on the number of interactions in ecological networks, we present a method to predict <span class="math inline"><em>L</em></span> from <span class="math inline"><em>S</em></span> (Box 1), thus allowing the prediction of the joint degree distribution from <span class="math inline"><em>S</em></span> solely. In turn, the second approach consists in finding, using different constraints, the adjacency matrix of maximum entropy from which network properties can be measured. To do so, we used a flexible and heuristic approach based on simulated annealing (an optimization algorithm) to find networks <em>close</em> to maximum entropy. As discussed above, our choice of algorithm stands from the very nature of food webs (i.e. simple directed networks allowing self-loops) that makes the analytical derivation of a maximum entropy graph model difficult. We first built our type I MaxEnt network model constrained by the connectance of the network (i.e. the ratio <span class="math inline"><em>L</em>/<em>S</em><sup>2</sup></span>). A comparison of this model against empirical data indicated that connectance alone was not sufficient to predict many aspects of network structure. For this reason, we built our type II MaxEnt network model, which instead uses the whole joint degree sequence as a constraint. Overall, we found that this second model was much better at predicting food-web structure than the one based on connectance.</p>
            <h1 id="data-and-code">Data and code</h1>
            <p>We tested our analytical and heuristic MaxEnt models against open food-web data queried from three different sources and integrated into what we call our <em>complete dataset</em>. These sources include (1) terrestrial and aquatic food webs sampled globally and archived on the ecological interactions database Mangal; (2) freshwater stream food webs from New Zealand; and (3) aquatic food webs from Tuesday Lake (Michigan, United States). First, all food webs archived on <code>mangal.io</code> <span class="citation" data-cites="Poisot2016ManMakb Banville2021ManJla">(Timothee Poisot et al. 2016; Banville, Vissault, and Poisot 2021)</span> were directly queried from the database (<span class="math inline"><em>n</em> = 235</span>). Most ecological networks archived on Mangal are multilayer networks, i.e. networks that describe different types of interactions. We kept all networks whose interactions were mainly of predation and herbivory types, and removed the largest network (<span class="math inline"><em>S</em> = 714</span>) for computational efficiency reasons. Then, to this set we added food webs from two different sources: the New-Zealand dataset <span class="citation" data-cites="Pomeranz2018DatInf">(<span class="math inline"><em>n</em> = 21</span>; Pomeranz et al. 2018)</span> and the Tuesday lake dataset <span class="citation" data-cites="Cohen2003EcoComa">(<span class="math inline"><em>n</em> = 2</span>; Cohen, Jonsson, and Carpenter 2003)</span>. Of these two datasets, <span class="math inline">19</span> networks had data on species’ relative abundances that were used in the neutral model (Box 2). These <span class="math inline">19</span> networks constitute our <em>abundance dataset</em>, which is a subset of our complete dataset.</p>
            <p>All code and data to reproduce this article are available at the Open Science Framework. Data cleaning, simulations and analyses were conducted in Julia v1.5.4.</p>
            <h1 id="analytical-models-measures-of-maximum-entropy">Analytical models: Measures of maximum entropy</h1>
            <h2 id="joint-degree-distribution">Joint degree distribution</h2>
            <p>The joint degree distribution <span class="math inline"><em>p</em>(<em>k</em><sub><em>i</em><em>n</em></sub>, <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>)</span> is a joint discrete probability distribution describing the probability that a species has <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> predators and <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> preys, with <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> and <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> <span class="math inline"><em>ϵ</em></span> <span class="math inline">[0, <em>S</em>]</span>. Basal species (e.g., plants) have a <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> of <span class="math inline">0</span>, whereas top predators have a <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> of <span class="math inline">0</span>. In contrast, the maximum number of preys and predators a species can have is set by the number of species <span class="math inline"><em>S</em></span> in the food web. Here we show how the joint degree distribution of maximum entropy can be obtained given knowledge of <span class="math inline"><em>S</em></span> and <span class="math inline"><em>L</em></span>.</p>
            <p>We want to maximize Shannon’s entropy</p>
            <p><span id="eq:entropy_jdd"><span class="math display">$$H = -\sum_{k_{in}=0}^S\sum_{k_{out}=0}^S p(k_{in},k_{out}) \log p(k_{in},k_{out})\qquad(3)$$</span></span></p>
            <p>subject to the following constraints:</p>
            <p><span id="eq:g1"><span class="math display">$$g_1 = \sum_{k_{in}=0}^S\sum_{k_{out}=0}^S p(k_{in},k_{out}) = 1;\qquad(4)$$</span></span></p>
            <p><span id="eq:g2"><span class="math display">$$g_2 = \sum_{k_{in}=0}^S\sum_{k_{out}=0}^S k_{in} p(k_{in},k_{out}) = \langle k_{in} \rangle = \frac{L}{S};\qquad(5)$$</span></span></p>
            <p><span id="eq:g3"><span class="math display">$$g_3 = \sum_{k_{in}=0}^S\sum_{k_{out}=0}^S k_{out} p(k_{in},k_{out}) = \langle k_{out} \rangle = \frac{L}{S}.\qquad(6)$$</span></span></p>
            <p>The first constraint <span class="math inline"><em>g</em><sub>1</sub></span> is our normalizing constraint, whereas the other two (<span class="math inline"><em>g</em><sub>2</sub></span> and <span class="math inline"><em>g</em><sub>3</sub></span>) fix the average of the marginal distributions of <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> and <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> to the linkage density <span class="math inline"><em>L</em>/<em>S</em></span>. It is important to notice that <span class="math inline">⟨<em>k</em><sub><em>i</em><em>n</em></sub>⟩ = ⟨<em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>⟩</span> because every edge is associated to a predator and a prey. Therefore, without any further constraints, we expect the joint degree distribution of maximum entropy to be a symmetric probability distribution with regards to <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> and <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span>. However, this does not mean that the joint degree <em>sequence</em> will be symmetric, since the joint degree sequence is essentially a random realization of its probabilistic counterpart.</p>
            <p>The joint probability distribution of maximum entropy given these constraints is found using the method of Lagrange multipliers. To do so, we seek to maximize the following expression:</p>
            <p><span id="eq:F_jdd"><span class="math display">$$F = H - \lambda_1(g_1-1)-\lambda_2\left( g_2-\frac{L}{S}\right) - \lambda_3 \left( g_3-\frac{L}{S}\right),\qquad(7)$$</span></span></p>
            <p>where <span class="math inline"><em>λ</em><sub>1</sub></span>, <span class="math inline"><em>λ</em><sub>2</sub></span>, and <span class="math inline"><em>λ</em><sub>3</sub></span> are the Lagrange multipliers. The probability distribution that maximizes entropy is obtained by finding these values. As pointed out in the introduction, <span class="math inline"><em>F</em></span> is just Shannon’s entropy to which we added terms that each sums to zero (our constraints). <span class="math inline"><em>F</em></span> is maximized by setting to 0 its partial derivative with respect to <span class="math inline"><em>p</em>(<em>k</em><sub><em>i</em><em>n</em></sub>, <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>)</span>. Because the derivative of a constant is zero, this gives us:</p>
            <p><span id="eq:lagrange_jdd"><span class="math display">$$\frac{\partial H}{\partial p(k_{in},k_{out})} = \lambda_1 \frac{\partial g_1}{\partial p(k_{in},k_{out})} + \lambda_2 \frac{\partial g_2}{\partial p(k_{in},k_{out})}+ \lambda_3 \frac{\partial g_3}{\partial p(k_{in},k_{out})}.\qquad(8)$$</span></span></p>
            <p>Evaluating the partial derivatives with respect to <span class="math inline"><em>p</em>(<em>k</em><sub><em>i</em><em>n</em></sub>, <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>)</span>, we obtain:</p>
            <p><span id="eq:lagrange2_jdd"><span class="math display"> − log <em>p</em>(<em>k</em><sub><em>i</em><em>n</em></sub>, <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>) − 1 = <em>λ</em><sub>1</sub> + <em>λ</em><sub>2</sub><em>k</em><sub><em>i</em><em>n</em></sub> + <em>λ</em><sub>3</sub><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>.   (9)</span></span></p>
            <p>Then, solving eq. 9 for <span class="math inline"><em>p</em>(<em>k</em><sub><em>i</em><em>n</em></sub>, <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>)</span>, we obtain:</p>
            <p><span id="eq:lagrange3_jdd"><span class="math display">$$p(k_{in},k_{out}) = \frac{e^{-\lambda_2k_{in}-\lambda_3k_{out}}}{Z},\qquad(10)$$</span></span></p>
            <p>where <span class="math inline"><em>Z</em> = <em>e</em><sup>1 + <em>λ</em><sub>1</sub></sup></span> is called the partition function. The partition function ensures that probabilities sum to 1 (our normalization constraint). It can be expressed in terms of <span class="math inline"><em>λ</em><sub>2</sub></span> and <span class="math inline"><em>λ</em><sub>3</sub></span> as follows:</p>
            <p><span id="eq:Z"><span class="math display">$$Z = \sum_{k_{in}=0}^S\sum_{k_{out}=0}^S e^{-\lambda_2k_{in}-\lambda_3k_{out}}.\qquad(11)$$</span></span></p>
            <p>After substituting <span class="math inline"><em>p</em>(<em>k</em><sub><em>i</em><em>n</em></sub>, <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub>)</span> in eq. 5 and eq. 6, we get a nonlinear system of two equations and two unknowns:</p>
            <p><span id="eq:lagrange4_jdd"><span class="math display">$$\frac{1}{Z}\sum_{k_{in}=0}^S\sum_{k_{out}=0}^S k_{in} e^{-\lambda_2k_{in}-\lambda_3k_{out}}  = \frac{L}{S};\qquad(12)$$</span></span></p>
            <p><span id="eq:lagrange5_jdd"><span class="math display">$$\frac{1}{Z}\sum_{k_{in}=0}^S\sum_{k_{out}=0}^S k_{out} e^{-\lambda_2k_{in}-\lambda_3k_{out}}  = \frac{L}{S}.\qquad(13)$$</span></span></p>
            <p>We solved eq. 12 and eq. 13 numerically using the Julia library <code>JuMP.jl</code> v0.21.8 <span class="citation" data-cites="Dunning2017JumMod">(Dunning, Huchette, and Lubin 2017)</span>. <code>JuMP.jl</code> supports nonlinear optimization problems by providing exact second derivatives that increase the accuracy and performance of its solvers. The estimated values of <span class="math inline"><em>λ</em><sub>2</sub></span> and <span class="math inline"><em>λ</em><sub>3</sub></span> can be substituted in eq. 10 to have a more workable expression for the joint degree distribution.</p>
            <p>We predicted the joint degree distribution of maximum entropy for each food web in our complete dataset, i.e. using their numbers of species and numbers of interactions as state variables. We then sampled one realization of the degree sequence for each network using the probabilities given by the joint degree distribution. In fig. 1 (left panels), we show the relationship between <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> and <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> standardized by the number of species in their networks, for empirical and maximum entropy joint degree distributions. We see that our model predicts higher values of generality and vulnerability compared to empirical food webs (i.e. relative values of <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> and <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> closer to <span class="math inline">1</span>). However, plotting the difference between predicted and empirical values for each species gives a different perspective. The right panel of fig. 1 presents these differences when species are ordered by their total degree in their network (i.e. by the sum of their in and out-degrees). Indeed, our predicted joint degree sequences have the same number of species as their empirical counterparts, but they are species agnostic; in other words, instead of predicting a value for each species directly, we predicted the entire joint degree sequence without taking into account species’ identity. The challenge is to associate predictions with empirical data. If we associate each node according to their rank in total degrees, we see that species predicted to be have a higher generality (number of preys) generally have a lower vulnerability (number of preys) than what is observed (and conversely). This is because the difference in total degree (<span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub> + <em>k</em><sub><em>i</em><em>n</em></sub></span>) is minimized when species are ordered by their total degrees in both predicted and empirical sets (i.e. the average sum of relative <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> and <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> is close to <span class="math inline">0</span> across all species). This result shows that the differences between predicted and empirical degrees (in and out) are low for most species when ordered by their total degrees and that there is no apparent biases towards in or out degrees. In fig. S1, we show how these differences change when species are instead ordered by their out-degrees (left panel) and in-degrees (right panel), respectively.</p>
            <figure>
            <img src="figures/joint_degree_dist.png" id="fig:joint_dd" alt="Figure 1: Relative number of predators (k_{in}) as a function of the relative number of preys (k_{out}) for each species in (a) empirical and (b) maximum entropy joint degree sequences. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). The predicted joint degree sequences were obtained after sampling one realization of the joint degree distribution of maximum entropy for each network. (c) Difference between predicted and empirical values when species are ordered according to their total degrees. In all panels, each dot corresponds to a single species in one of the network of our complete dataset." /><figcaption aria-hidden="true">Figure 1: Relative number of predators (<span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span>) as a function of the relative number of preys (<span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span>) for each species in (a) empirical and (b) maximum entropy joint degree sequences. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). The predicted joint degree sequences were obtained after sampling one realization of the joint degree distribution of maximum entropy for each network. (c) Difference between predicted and empirical values when species are ordered according to their total degrees. In all panels, each dot corresponds to a single species in one of the network of our complete dataset.</figcaption>
            </figure>
            <p>We can describe the shape of the joint degree distribution by comparing its marginal distributions with one another. Doing so allows us to evaluate how much the shape of the joint degree distribution of maximum entropy differs from empirical data. We plotted the Kullback–Leibler (KL) divergence between in and out-degree sequences to compare the symmetry of empirical and maximum entropy joint degree sequences fig. 2. As we expected, our model predicted more similar in-degree and out-degree distributions than empirical data (shown by a lower KL divergence). However, this difference decreased with connectance right panel of 2. This suggests that other ecological constraints might be needed to account for the asymmetry of the joint degree distribution, especially for networks with a lower connectance. This might be due to the fact that food webs with low connectance are typically harder to predict than food webs with high connectance. Indeed, in low connectance systems, what makes two species interact might be more important for predictions than in high connectance systems, in which what prevents species from interacting might be more meaningful. This implies that more ecological information might be needed in food webs with fewer numbers of interactions because more nuances determine interactions compared to non-interactions.</p>
            <figure>
            <img src="figures/kl_divergence.png" id="fig:kl_diverg" alt="Figure 2: (a) Probability density of KL divergence between in and out-degree sequences of empirical and maximum entropy joint degree sequences. (b) Difference between the KL divergence of empirical and predicted networks as a function of connectance. In both panels, empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). The joint degree sequence of simulated networks was obtained after sampling one realization of the joint degree distribution of maximum entropy for each network." /><figcaption aria-hidden="true">Figure 2: (a) Probability density of KL divergence between in and out-degree sequences of empirical and maximum entropy joint degree sequences. (b) Difference between the KL divergence of empirical and predicted networks as a function of connectance. In both panels, empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). The joint degree sequence of simulated networks was obtained after sampling one realization of the joint degree distribution of maximum entropy for each network.</figcaption>
            </figure>
            <h2 id="degree-distribution">Degree distribution</h2>
            <p>The degree distribution <span class="math inline"><em>p</em>(<em>k</em>)</span> represents the probability that a species has <span class="math inline"><em>k</em></span> interactions in a food web, with <span class="math inline"><em>k</em> = <em>k</em><sub><em>i</em><em>n</em></sub> + <em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span>. It can thus be directly obtained from the joint degree distribution:</p>
            <p><span class="math display">$$p(k) = \sum_{i=0}^k p(k_{in} = k - i, k_{out} = i).$$</span></p>
            <p>In fig. S2, we show that the degree distribution of maximum entropy, given <span class="math inline"><em>S</em></span> and <span class="math inline"><em>L</em></span>, predicts very low probabilities that a species will be isolated in its food web (i.e. having <span class="math inline"><em>k</em> = 0</span>). As <span class="citation" data-cites="MacDonald2020RevLin">MacDonald, Banville, and Poisot (2020)</span> pointed out, the size of food webs should at least be of <span class="math inline"><em>S</em> − 1</span> interactions, since a lower number would yield isolated species, i.e. species without any predators or preys. Our results show that, under our purely information-theoretic model, the probability that a species is isolated is quite high when the total number of interactions is below this threshold. The expected proportion of isolated species rapidly declines by orders of magnitude with increasing numbers of species and interactions.</p>
            <p>The degree distribution could also have been obtained directly using the principle of maximum entropy, as discussed in <span class="citation" data-cites="Williams2011BioMet">Williams (2011)</span>. This gives the following distribution:</p>
            <p><span id="eq:lagrange_dd"><span class="math display">$$p(k) = \frac{e^{-\lambda_2k}}{Z},\qquad(14)$$</span></span></p>
            <p>with <span class="math inline">$Z = \sum_{k=0}^S e^{-\lambda_2k}.$</span></p>
            <p>This can be solved numerically using the constraint of the average degree <span class="math inline">$\langle k \rangle = \frac{2L}{S}$</span> of a species. Note that the mean degree is twice the value of the linkage density, because every link must be counted twice when we add in and out-degrees together.</p>
            <p><span id="eq:lagrange2_dd"><span class="math display">$$\frac{1}{Z}\sum_{k=0}^S k e^{-\lambda_2k} = \frac{2L}{S}\qquad(15)$$</span></span></p>
            <p>The numerical solution is identical to the one we obtained using the joint degree distribution as an intermediate. Ecologists wanting to model a system without considering isolated species could simply change the lower limit of <span class="math inline"><em>k</em></span> to <span class="math inline">1</span> and solve the resulting equation numerically.</p>
            <p>In this section, we showed how important measures of food-web structure, namely the degree distribution and the joint degree distribution, could be derived with the principle of maximum entropy using minimal knowledge on a biological community. This type of models, although useful to make least-biased predictions on many network properties, can be hard to apply for other measures. Indeed, there are dozens of measures of network structure <span class="citation" data-cites="Delmas2019AnaEco">(Delmas et al. 2019)</span> and many are not calculated with mathematical equations, but with algorithms. Moreover, the applicability of this method to empirical systems is limited by the state variables we can actually measure and use. In the next section, we propose a more flexible method to predict many measures of network structure simultaneously, i.e. by finding heuristically the configuration of the network having maximum entropy given partial knowledge of its emerging structure.</p>
            <h1 id="box-1---working-with-predicted-numbers-of-interactions">Box 1 - Working with predicted numbers of interactions</h1>
            <p>Our models need information on the number of species and the number of interactions. However, since the later is rarely estimated empirically, ecologists might need to use predictive methods to estimate the total number of interactions in a food web.</p>
            <p>We used the flexible links model of <span class="citation" data-cites="MacDonald2020RevLin">MacDonald, Banville, and Poisot (2020)</span> to predict the number of interactions from the number of species. The flexible links model, in contrast to other predictive models of the number of interactions, incorporates meaningful ecological constraints into the prediction of <span class="math inline"><em>L</em></span>, namely the minimum <span class="math inline"><em>S</em> − 1</span> and maximum <span class="math inline"><em>S</em><sup>2</sup></span> numbers of interactions in food webs. It estimates the proportion of the <span class="math inline"><em>S</em><sup>2</sup> − (<em>S</em> − 1)</span> <em>flexible links</em> that are realized. More precisely, this model states that the number of <em>realized</em> flexible links (or interactions) <span class="math inline"><em>L</em><sub><em>F</em><em>L</em></sub></span> in a food web represents the number of realized interactions above the minimum (i.e. <span class="math inline"><em>L</em> = <em>L</em><sub><em>F</em><em>L</em></sub> + <em>S</em> − 1</span>) and is obtained from a beta-binomial distribution with <span class="math inline"><em>S</em><sup>2</sup> − (<em>S</em> − 1)</span> trials and parameters <span class="math inline"><em>α</em> = <em>μ</em><em>e</em><sup><em>ϕ</em></sup></span> and <span class="math inline"><em>β</em> = (1 − <em>μ</em>)<em>e</em><sup><em>ϕ</em></sup></span>:</p>
            <p><span id="eq:BB"><span class="math display"><em>L</em><sub><em>F</em><em>L</em></sub> ∼ <em>B</em><em>B</em>(<em>S</em><sup>2</sup> − (<em>S</em> − 1), <em>μ</em><em>e</em><sup><em>ϕ</em></sup>, (1 − <em>μ</em>)<em>e</em><sup><em>ϕ</em></sup>),   (16)</span></span></p>
            <p>where <span class="math inline"><em>μ</em></span> is the average probability across food webs that a flexible link is realized, and <span class="math inline"><em>ϕ</em></span> is the concentration parameter around <span class="math inline"><em>μ</em></span>.</p>
            <p>We fitted the flexible links model on all food webs in our complete dataset, and estimated the parameters of eq. 16 using a Hamiltonian Monte Carlo sampler with static trajectory (<span class="math inline">1</span> chain and <span class="math inline">3000</span> iterations):</p>
            <p><span id="eq:BBpost"><span class="math display">$$ [\mu, \phi| \textbf{L}, \textbf{S}] \propto \prod_{i = 1}^{m} \mathrm{BB}(L_i - (S_i - 1) | S_i^2 - (S_i - 1)), \mu e^{\phi}, (1 - \mu) e^\phi) \times \mathrm{B}(\mu| 3 , 7 ) \times \mathcal{N}(\phi | 3, 0.5), \qquad(17)$$</span></span></p>
            <p>where <span class="math inline"><em>m</em></span> is the number of food webs (<span class="math inline"><em>m</em> = 257</span>) and <span class="math inline"><strong>L</strong></span> and <span class="math inline"><strong>S</strong></span> are respectively the vectors of their numbers of interactions and numbers of species. Our weakly-informative prior distributions were chosen following <span class="citation" data-cites="MacDonald2020RevLin">MacDonald, Banville, and Poisot (2020)</span>, i.e. a beta distribution for <span class="math inline"><em>μ</em></span> and a normal distribution for <span class="math inline"><em>ϕ</em></span>. The Monte Carlo sampling of the posterior distribution was conducted using the Julia library <code>Turing</code> v0.15.12.</p>
            <p>The flexible links model is a generative model, i.e. it can generate plausible values of the predicted variable. We thus simulated <span class="math inline">1000</span> values of <span class="math inline"><em>L</em></span> for different values of <span class="math inline"><em>S</em></span> using the joint posterior distribution of our model parameters (eq. 17), and calculated the mean degree for each simulated values. The resulting distributions are shown in the left panel of fig. 3 for three different values of species richness. In the right panel of fig. 3, we show how the probability distribution for the mean degree constraints can be used to generate a distribution of maximum entropy degree distributions, since each simulated value of mean degree generates a different maximum entropy degree distribution (eq. 14 and eq. 15).</p>
            <figure>
            <img src="figures/maxent_degree_dist_fl.png" id="fig:degree_dist_fl" alt="Figure 3: (a) Probability density of the predicted mean degree for different values of species richness. The number of interactions was predicted using the flexible links model fitted to all empirical networks in our complete dataset (eq. 17). (b) Degree distributions of maximum entropy for a network of S=27 species and different numbers of interactions L. The numbers of interactions correspond to the lower and upper bounds of the 67%, 89%, and 97% percentile intervals (PI), as well as the median (in blue), of the counterfactuals of the flexible links model. Each degree distribution was obtained using eq. 14 after solving numerically eq. 15 using different values for the mean degree constraint 2L/S." /><figcaption aria-hidden="true">Figure 3: (a) Probability density of the predicted mean degree for different values of species richness. The number of interactions was predicted using the flexible links model fitted to all empirical networks in our complete dataset (eq. 17). (b) Degree distributions of maximum entropy for a network of <span class="math inline"><em>S</em> = 27</span> species and different numbers of interactions <span class="math inline"><em>L</em></span>. The numbers of interactions correspond to the lower and upper bounds of the <span class="math inline">67</span>, <span class="math inline">89</span>, and <span class="math inline">97</span> percentile intervals (PI), as well as the median (in blue), of the counterfactuals of the flexible links model. Each degree distribution was obtained using eq. 14 after solving numerically eq. 15 using different values for the mean degree constraint <span class="math inline">2<em>L</em>/<em>S</em></span>.</figcaption>
            </figure>
            <h1 id="box-2---corresponding-null-and-neutral-models">Box 2 - Corresponding null and neutral models</h1>
            <h2 id="null-models-types-i-and-ii">Null models (types I and II)</h2>
            <p>Our heuristic MaxEnt models, predicting adjacency matrices, were compared with two topological null models. The first is the type I null model of <span class="citation" data-cites="Fortuna2006HabLos">Fortuna and Bascompte (2006)</span>, in which the probability that a species <span class="math inline"><em>i</em></span> predates on another species <span class="math inline"><em>j</em></span> is given by</p>
            <p><span id="eq:type1null"><span class="math display">$$p(i \rightarrow j) = \frac{L}{S^2}.\qquad(18)$$</span></span></p>
            <p>The second is the type II null model of <span class="citation" data-cites="Bascompte2003NesAssa">Bascompte et al. (2003)</span>, in which the probability of interaction is instead given by</p>
            <p><span id="eq:type2null"><span class="math display">$$p(i \rightarrow j) = \frac{1}{2} \left(\frac{k_{in}(j)}{S} + \frac{k_{out}(i)}{S}\right),\qquad(19)$$</span></span></p>
            <p>where <span class="math inline"><em>k</em><sub><em>i</em><em>n</em></sub></span> and <span class="math inline"><em>k</em><sub><em>o</em><em>u</em><em>t</em></sub></span> are the in and out-degrees, respectively. The type I null model is based on connectance, whereas the type II null model is based on the joint degree sequence. Therefore, the type I and II topological null models correspond with our type I and II MaxEnt network models, respectively, since they use similar constraints.</p>
            <p>We predicted both types of null networks for all empirical networks in our complete dataset (<span class="math inline"><em>n</em> = 257</span>). We converted all probabilistic networks to Boolean networks by generating <span class="math inline">100</span> random Boolean networks for each of these probabilistic webs. Then, we counted the number of times each interaction was sampled, and kept the <span class="math inline"><em>L</em></span> entries that were drawn the most amount of time, with <span class="math inline"><em>L</em></span> given by the number of interactions in each food web. This ensured that the resulting null networks had the same number of interactions as their empirical counterparts.</p>
            <h2 id="neutral-model">Neutral model</h2>
            <p>We also compared our MaxEnt network models with a neutral model of relative abundances, in which the probabilities of interaction are given by</p>
            <p><span id="eq:neutralmodel"><span class="math display">$$p(i \rightarrow j) \propto \frac{n_i}{N} \times \frac{n_j}{N},\qquad(20)$$</span></span></p>
            <p>where <span class="math inline"><em>n</em><sub><em>i</em></sub></span> and <span class="math inline"><em>n</em><sub><em>j</em></sub></span> are the abundances (or biomass) of both species, and <span class="math inline"><em>N</em></span> is the total abundance (or biomass) of all species in the network. We predicted neutral abundance matrices for all empirical networks in our abundance dataset (<span class="math inline"><em>n</em> = 19</span>), and converted these weighted matrices to Boolean networks using an approach analogue to the one we used for our null models.</p>
            <h1 id="heuristic-models-networks-of-maximum-entropy">Heuristic models: Networks of maximum entropy</h1>
            <h2 id="from-shannons-to-svd-entropy">From Shannon’s to SVD entropy</h2>
            <p>The principle of maximum entropy can be applied on the network itself if we decompose its adjacency matrix into a non-zero vector of relative values. This is a necessary step when working with food webs, which are frequently expressed as a matrix <span class="math inline"><em>A</em> = [<em>a</em><sub><em>i</em><em>j</em></sub>]</span> of Boolean values representing the presence (<span class="math inline"><em>a</em><sub><em>i</em><em>j</em></sub> = 1</span>) or absence (<span class="math inline"><em>a</em><sub><em>i</em><em>j</em></sub> = 0</span>) of an interaction between two species <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span>. Knowing one or many properties of a food web of interest (e.g., its number of species and number of interactions), we can simulate its adjacency matrix randomly by using these known ecological information to constrain the space of potential networks. The entropy of this hypothetical matrix can then be measured after decomposing it into appropriate values. Simulating a series of networks until we find the one having the highest entropy allows us to search for the most complex food-web configuration given the ecological constraints used. This configuration is the least biased one considering the information we had. In other words, the most we can say about a network’s adjacency matrix, without making more assumptions than the ones given by our incomplete knowledge of its structure, is the one of maximum entropy. Generating the most complex network that corresponds to this structure allows us to explore more easily other properties of food webs under MaxEnt.</p>
            <p>Shannon’s entropy can only be calculated on conventional probability distributions such as the joint degree distribution. This is an issue when working with ecological networks, which are represented as adjacency matrices. For this reason, we need to use another measure of entropy if we want to predict the network itself. We used the SVD entropy as our measure of entropy, which is an application of Shannon’s entropy to the relative non-zero singular values of a truncated singular value decomposition <span class="citation" data-cites="Strydom2021SvdEnt">(t-SVD; Strydom, Dalla Riva, and Poisot 2021)</span> of a food web’s Boolean adjacency matrix. We measured SVD entropy as follows:</p>
            <p><span id="eq:svd-entropy"><span class="math display">$$J = -\sum_{i=1}^R s_i \log s_i,\qquad(21)$$</span></span></p>
            <p>where <span class="math inline"><em>s</em><sub><em>i</em></sub></span> are the relative singular values of the adjacency matrix (<span class="math inline">$s_i = \sigma_i / \sum_{i = 1}^R \sigma_i$</span>, where <span class="math inline"><em>σ</em><sub><em>i</em></sub></span> are the singular values). Note that the distribution of relative singular values is analogous to a probability distribution, with <span class="math inline">0 &lt; <em>s</em><sub><em>i</em></sub> &lt; 1</span> and <span class="math inline">∑<em>s</em><sub><em>i</em></sub> = 1</span>. Thus, this measure also satisfies all four properties of an appropriate entropy measure (see introduction), while being a proper measure of the internal complexity of food webs <span class="citation" data-cites="Strydom2021SvdEnt">(Strydom, Dalla Riva, and Poisot 2021)</span>. Following <span class="citation" data-cites="Strydom2021SvdEnt">Strydom, Dalla Riva, and Poisot (2021)</span>, we standardized this measure with the rank <span class="math inline"><em>R</em></span> of the matrix (i.e. <span class="math inline"><em>J</em>/ln (<em>R</em>)</span>) to account for the difference in dimensions between networks <span class="citation" data-cites="Pielou1975EcoDiv">(<em>sensu</em> Pielou’s evenness; Pielou 1975)</span>. We used SVD entropy to predict the network configuration of maximum entropy (i.e. of maximum complexity) heuristically given a predetermined set of constraints.</p>
            <h2 id="maxent-network-models-types-i-and-ii">MaxEnt network models (types I and II)</h2>
            <p>We built two types of MaxEnt network models: one based on connectance (type I MaxEnt network model) and the other based on the joint degree sequence (type II MaxEnt network model). They are based on the same constraints as the types I and II null models presented above. For both models, we used a simulated annealing algorithm with <span class="math inline">4</span> chains, <span class="math inline">2000</span> steps and an initial temperature of <span class="math inline">0.2</span>. For each chain, we first generated one random Boolean matrix with the same order (number of species) as empirical webs, while maintaining the total number of interactions (type I MaxEnt network model) or rows and columns sums (type II MaxEnt network model). These are our initial configurations. Then, we swapped interactions sequentially while maintaining the original connectance or the joint degree sequence for types I and II MaxEnt network model, respectively. Configurations with a higher SVD entropy than the previous one in the chain were always accepted, whereas they were accepted with a probability conditional to a decreasing temperature when lower. The final configuration with the highest SVD entropy among the four chains constitute our estimated MaxEnt network. Even though we decided to work with point estimates, it is possible to have a (non MaxEnt) probability distribution of networks when working with the entire chains (or part of the chains). For each network in our complete and abundance datasets, we estimated their configuration with maximum entropy using both types of MaxEnt network models.</p>
            <h2 id="structure-of-maxent-networks">Structure of MaxEnt networks</h2>
            <p>We compared different measures of the structure of empirical food webs with the ones of null, neutral, and MaxEnt networks tbl. 1, and 2. For instance, we measured the nestedness <span class="math inline"><em>ρ</em></span> according to <span class="citation" data-cites="Staniczenko2013GhoNes">Staniczenko, Kopp, and Allesina (2013)</span>, i.e. using the spectral radius of the adjacency matrix. Nestedness indicates how much the diet of specialist species is a subset of the one of generalists, and is strongly associated with network modularity <span class="citation" data-cites="Fortuna2010NesMod">(Fortuna et al. 2010)</span>. We also measured the maximum trophic level <em>maxtl</em>, network diameter <em>diam</em> <span class="citation" data-cites="Albert2002StaMec">(i.e. the longest of the shortest paths between all species pairs; Albert and Barabasi 2002)</span>, the average maximum similarity between species pairs <em>MxSim</em>, the proportion of cannibal species <em>Cannib</em> (i.e. the proportion of self loops), and the proportion of omnivorous species <em>Omniv</em> (i.e. species whose preys are of different trophic levels). <em>MxSim</em>, <em>Cannib</em>, and <em>Omniv</em> are more deeply defined in <span class="citation" data-cites="Williams2000SimRul">Williams and Martinez (2000)</span>.</p>
            <p>Overall, we found that models based on the joint degree sequence (type II null and MaxEnt network models) reproduced the structure of empirical networks much better than the ones based on connectance and the neutral model of relative abundances. On average, the type II MaxEnt network model was better at predicting nestedness (<span class="math inline">0.62 ± 0.08</span>) than its corresponding null model (<span class="math inline">0.73 ± 0.05</span>; empirical networks: <span class="math inline">0.63 ± 0.09</span>), as well as the proportion of cannibal species. This might in part be due because nestedness was calculated using the spectral radius of the adjacency matrix, which leverages information on the network itself just like the MaxEnt network models. However, the type II null model was better at predicting network diameter and average maximum similarity between species pairs. Predictions were similar between both type II models for the maximum trophic level and the proportion of omnivorous species.</p>
            <div id="tbl:measures_all">
            <table>
            <caption>Table 1: Standardized mean differences of predicted network measures with empirical data for all networks (<span class="math inline"><em>n</em> = 257</span>). Positive (negative) values indicate that the measure is overestimated (underestimated) on average. Empirical networks are all food webs archived on Mangal, as well as the New Zealand and Tuesday lake food webs (our complete dataset). Null 1: Type I null model based on connectance. MaxEnt 1: Type I MaxEnt network model based on connectance. Null 2: Type II null model based on the joint degree sequence. MaxEnt 2: Type II MaxEnt network model based on the joint degree sequence. <span class="math inline"><em>ρ</em></span>: nestedness measured by the spectral radius of the adjacency matrix. <em>maxtl</em>: maximum trophic level. <em>diam</em>: network diameter. <em>MxSim</em>: average maximum similarity between species pairs. <em>Cannib</em>: proportion of cannibal species (self loops). <em>Omniv</em>: proportion of omnivorous species. <em>entropy</em>: SVD entropy.</caption>
            <thead>
            <tr class="header">
            <th style="text-align: right;">model</th>
            <th style="text-align: right;">rho</th>
            <th style="text-align: right;">maxtl</th>
            <th style="text-align: right;">diam</th>
            <th style="text-align: right;">MxSim</th>
            <th style="text-align: right;">Cannib</th>
            <th style="text-align: right;">Omniv</th>
            <th style="text-align: right;">entropy</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td style="text-align: right;">null 1</td>
            <td style="text-align: right;">-0.167</td>
            <td style="text-align: right;">0.980</td>
            <td style="text-align: right;">1.428</td>
            <td style="text-align: right;">-0.502</td>
            <td style="text-align: right;">2.007</td>
            <td style="text-align: right;">1.493</td>
            <td style="text-align: right;">0.056</td>
            </tr>
            <tr class="even">
            <td style="text-align: right;">MaxEnt 1</td>
            <td style="text-align: right;">-0.226</td>
            <td style="text-align: right;">0.831</td>
            <td style="text-align: right;">1.274</td>
            <td style="text-align: right;">-0.524</td>
            <td style="text-align: right;">1.982</td>
            <td style="text-align: right;">1.863</td>
            <td style="text-align: right;">0.106</td>
            </tr>
            <tr class="odd">
            <td style="text-align: right;">null 2</td>
            <td style="text-align: right;">0.160</td>
            <td style="text-align: right;">-0.125</td>
            <td style="text-align: right;">0.016</td>
            <td style="text-align: right;">0.007</td>
            <td style="text-align: right;">1.078</td>
            <td style="text-align: right;">0.559</td>
            <td style="text-align: right;">-0.023</td>
            </tr>
            <tr class="even">
            <td style="text-align: right;">MaxEnt 2</td>
            <td style="text-align: right;">-0.015</td>
            <td style="text-align: right;">0.178</td>
            <td style="text-align: right;">0.565</td>
            <td style="text-align: right;">-0.282</td>
            <td style="text-align: right;">0.698</td>
            <td style="text-align: right;">0.589</td>
            <td style="text-align: right;">0.058</td>
            </tr>
            </tbody>
            </table>
            </div>
            <div id="tbl:measures_abund">
            <table>
            <caption>Table 2: Standardized mean differences of predicted network measures with empirical data for networks having abundance data (<span class="math inline"><em>n</em> = 19</span>). Positive (negative) values indicate that the measure is overestimated (underestimated) on average. Empirical networks are all New Zealand and Tuesday lake food webs with abundance data (our abundance dataset). Null 1: Type I null model based on connectance. MaxEnt 1: Type I MaxEnt network model based on connectance. Null 2: Type II null model based on the joint degree sequence. MaxEnt 2: Type II MaxEnt network model based on the joint degree sequence. <span class="math inline"><em>ρ</em></span>: nestedness measured by the spectral radius of the adjacency matrix. <em>maxtl</em>: maximum trophic level. <em>diam</em>: network diameter. <em>MxSim</em>: average maximum similarity between species pairs. <em>Cannib</em>: proportion of cannibal species (self loops). <em>Omniv</em>: proportion of omnivorous species. <em>entropy</em>: SVD entropy.</caption>
            <thead>
            <tr class="header">
            <th style="text-align: right;">model</th>
            <th style="text-align: right;">rho</th>
            <th style="text-align: right;">maxtl</th>
            <th style="text-align: right;">diam</th>
            <th style="text-align: right;">MxSim</th>
            <th style="text-align: right;">Cannib</th>
            <th style="text-align: right;">Omniv</th>
            <th style="text-align: right;">entropy</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td style="text-align: right;">neutral</td>
            <td style="text-align: right;">0.367</td>
            <td style="text-align: right;">-0.090</td>
            <td style="text-align: right;">0.027</td>
            <td style="text-align: right;">0.266</td>
            <td style="text-align: right;">6.870</td>
            <td style="text-align: right;">0.576</td>
            <td style="text-align: right;">-0.083</td>
            </tr>
            <tr class="even">
            <td style="text-align: right;">null 1</td>
            <td style="text-align: right;">-0.134</td>
            <td style="text-align: right;">0.950</td>
            <td style="text-align: right;">1.919</td>
            <td style="text-align: right;">-0.369</td>
            <td style="text-align: right;">2.077</td>
            <td style="text-align: right;">0.614</td>
            <td style="text-align: right;">0.068</td>
            </tr>
            <tr class="odd">
            <td style="text-align: right;">MaxEnt 1</td>
            <td style="text-align: right;">-0.229</td>
            <td style="text-align: right;">1.020</td>
            <td style="text-align: right;">1.946</td>
            <td style="text-align: right;">-0.355</td>
            <td style="text-align: right;">2.215</td>
            <td style="text-align: right;">0.801</td>
            <td style="text-align: right;">0.121</td>
            </tr>
            <tr class="even">
            <td style="text-align: right;">null 2</td>
            <td style="text-align: right;">0.128</td>
            <td style="text-align: right;">-0.115</td>
            <td style="text-align: right;">-0.135</td>
            <td style="text-align: right;">0.157</td>
            <td style="text-align: right;">1.444</td>
            <td style="text-align: right;">0.029</td>
            <td style="text-align: right;">-0.021</td>
            </tr>
            <tr class="odd">
            <td style="text-align: right;">MaxEnt 2</td>
            <td style="text-align: right;">-0.010</td>
            <td style="text-align: right;">0.054</td>
            <td style="text-align: right;">0.243</td>
            <td style="text-align: right;">-0.062</td>
            <td style="text-align: right;">-0.038</td>
            <td style="text-align: right;">0.083</td>
            <td style="text-align: right;">0.038</td>
            </tr>
            </tbody>
            </table>
            </div>
            <p>The picture slightly changes when we consider another important property of ecological networks, i.e. their motifs profile. We measured the proportion of three-species motifs, which can be considered as simple building blocks of ecological networks <span class="citation" data-cites="Milo2002NetMot Stouffer2007EviExi">(Milo et al. 2002; Stouffer et al. 2007)</span>. Motifs are the backbone of complex ecological networks from which network structure is built upon and play a crucial role in community dynamics and assembly <span class="citation" data-cites="Bastolla2009ArcMut Stouffer2011ComInc">(Bastolla et al. 2009; Stouffer and Bascompte 2011)</span>. In fig. 4, we show that the motifs profile of networks generated using the type II MaxEnt network model was very close to the one of empirical data, and that they made better predictions than the type II null model. This is also shown in fig. 5, where we see that relationships between motifs pairs of empirical food webs are very similar to the ones of the type II MaxEnt networks. Overall, these results suggest that the type II MaxEnt network model can reproduce many aspects of network structure. This highlights the importance of the joint degree sequence in shaping ecological networks.</p>
            <figure>
            <img src="figures/motifs_distribution.png" id="fig:motifs" alt="Figure 4: Motifs profile of empirical, maximum entropy, and null food webs. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). Maximum entropy networks were estimated using a simulated annealing algorithm to find the network of maximum SVD entropy while maintaining the connectance (type I MaxEnt network model) or the joint degree sequence (type II MaxEnt network model). The predictions of the types I and II null models are also plotted. Boxplots display the median proportions of each motif (middle horizontal lines), as well as the first (bottom horizontal lines) and third (top horizontal lines) quartiles. Vertical lines encompass all data points that fall within 1.5 times the interquartile range from both quartiles, and dots are data points that fall outside this range. Motifs names are from Stouffer et al. (2007)." /><figcaption aria-hidden="true">Figure 4: Motifs profile of empirical, maximum entropy, and null food webs. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). Maximum entropy networks were estimated using a simulated annealing algorithm to find the network of maximum SVD entropy while maintaining the connectance (type I MaxEnt network model) or the joint degree sequence (type II MaxEnt network model). The predictions of the types I and II null models are also plotted. Boxplots display the median proportions of each motif (middle horizontal lines), as well as the first (bottom horizontal lines) and third (top horizontal lines) quartiles. Vertical lines encompass all data points that fall within <span class="math inline">1.5</span> times the interquartile range from both quartiles, and dots are data points that fall outside this range. Motifs names are from <span class="citation" data-cites="Stouffer2007EviExi">Stouffer et al. (2007)</span>.</figcaption>
            </figure>
            <figure>
            <img src="figures/motifs_relations.png" id="fig:motifs_rel" alt="Figure 5: Relationship between motifs proportions of empirical, maximum entropy, and null food webs. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). Maximum entropy networks were estimated using a simulated annealing algorithm to find the network of maximum SVD entropy while maintaining the connectance (type I MaxEnt network model) or the joint degree sequence (type II MaxEnt network model). The predictions of the types I and II null models are also plotted. Regression lines are plotted in each panel. Motifs names are from Stouffer et al. (2007)." /><figcaption aria-hidden="true">Figure 5: Relationship between motifs proportions of empirical, maximum entropy, and null food webs. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). Maximum entropy networks were estimated using a simulated annealing algorithm to find the network of maximum SVD entropy while maintaining the connectance (type I MaxEnt network model) or the joint degree sequence (type II MaxEnt network model). The predictions of the types I and II null models are also plotted. Regression lines are plotted in each panel. Motifs names are from <span class="citation" data-cites="Stouffer2007EviExi">Stouffer et al. (2007)</span>.</figcaption>
            </figure>
            <p>Moreover, we found that empirical networks are close to their maximum entropy considering a fixed joint degree sequence (fig. S3). Empirical networks had an SVD entropy of <span class="math inline">0.89 ± 0.04</span>, compared to type II MaxEnt networks which had values of <span class="math inline">0.94 ± 0.03</span>. The relationship between the SVD entropy of empirical food webs and their maximum entropy configuration is plotted in the last panel of fig. 6. We also found no relationship between the difference in SVD entropy between empirical and type II MaxEnt networks and species richness, the number of interactions, or connectance (fig. S4). Similarly, we found no correlation between the difference in SVD entropy and the Jaccard distance of empirical and type II MaxEnt networks.</p>
            <p>Finally, in fig. 6 we also show how well empirical measures are predicted using the type II MaxEnt network model. In accordance with our previous results, we found that nestedness was very well predicted by our model. However, the type II MaxEnt network model overestimated the maximum trophic level and network diameter, especially for networks with high empirical values. In fig. S5, we show that the pairwise relationships between these four measures and species richness in empirical food webs are similar (in magnitude and sign) to the ones in type II MaxEnt networks.</p>
            <figure>
            <img src="figures/measures_emp_maxent.png" id="fig:measures" alt="Figure 6: Relationship between the structure of empirical and maximum entropy food webs. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). Maximum entropy networks were estimated using a simulated annealing algorithm to find the network of maximum SVD entropy while maintaining the joint degree sequence (type II MaxEnt network model). (a) Nestedness (estimated using the spectral radius of the adjacency matrix), (b) the maximum trophic level, (c) the network diameter, and (d) the SVD entropy were measured on these empirical and maximum entropy food webs. The identity line is plotted in each panel." /><figcaption aria-hidden="true">Figure 6: Relationship between the structure of empirical and maximum entropy food webs. Empirical networks include all food webs archived on Mangal, as well as the New-Zealand and Tuesday lake datasets (our complete dataset). Maximum entropy networks were estimated using a simulated annealing algorithm to find the network of maximum SVD entropy while maintaining the joint degree sequence (type II MaxEnt network model). (a) Nestedness (estimated using the spectral radius of the adjacency matrix), (b) the maximum trophic level, (c) the network diameter, and (d) the SVD entropy were measured on these empirical and maximum entropy food webs. The identity line is plotted in each panel.</figcaption>
            </figure>
            <h1 id="discussion">Discussion</h1>
            <p>The principle of maximum entropy is a robust mathematical method of finding least-biased probability distributions that have some desired properties given by prior knowledge on a system. We first used MaxEnt to predict the joint degree distribution and the degree distribution of maximum entropy given known numbers of species and of interactions. We found that the resulting joint degree distributions were more symmetric than the ones of empirical food webs, which suggests that other constraints might be needed to improve those predictions. We also used MaxEnt to predict networks of maximum entropy with a specified structure. These networks are the most complex, or random, given the constraints used. Likewise, we found that knowledge of species richness and of the number of interactions were not sufficient to reproduce many aspects of network structure found in nature. However, a model based on the entire joint degree sequence, i.e. on the number of preys and predators for each species, gave more convincing results. Our type II MaxEnt network model yielded better or similar predictions than the type II null model, also based on the joint degree sequence, for most measures considered including the motifs profile. This suggests that the joint degree sequence drives many aspects of network structure. Indeed, considering our findings that empirical networks are close to maximum entropy for a given joint degree sequence, our results suggest that food-web topology is configured almost entirely randomly around these marginal numbers of predators and preys.</p>
            <p>Our results bring to the forefront the role of the joint degree distribution in shaping food-web structure. This echoes the work of <span class="citation" data-cites="Williams2011BioMet">Williams (2011)</span>, which shows using MaxEnt how the degree distribution can drive the structure of bipartite networks. <span class="citation" data-cites="Fortuna2010NesMod">Fortuna et al. (2010)</span> also found that the degree distribution of ecological networks is associated with some of their emerging properties such as nestedness and modularity. Network ecologists tend to focus on several emerging properties of food webs <span class="citation" data-cites="Delmas2019AnaEco">(Delmas et al. 2019)</span>, although we show that food-web structure is very well predicted by the joint degree distribution. In the light of our results, there is a lot more ecological information in the difference between properties of empirical networks and MaxEnt predictions than in these properties themselves.</p>
            <h2 id="alternative-maxent-models">Alternative MaxEnt models</h2>
            <p>There are different ways to generate food webs using MaxEnt. In this contribution, we used a method based on simulated annealing to find the network configuration with the highest SVD entropy while fixing some aspects of its structure. Another technique, also based on simulated annealing, could start by generating a food web randomly with fixed numbers of species and interactions and calculating its joint degree distribution. Pairs of interactions could be swapped sequentially until we minimize the divergence between the calculated joint degree distribution and the one of maximum entropy obtained analytically. In that case, this is the entropy of the joint degree distribution that would be maximized, not the one of the network’s topology. To a certain extent, this method would thus bridge the gap between the two approaches presented in this article (i.e. analytical and heuristic MaxEnt models). More research is needed to compare the quality of different methods generating adjacency matrices of food webs using MaxEnt.</p>
            <p>Another method generating adjacency matrices are maximum entropy graph models, which predict a probability distribution of networks under soft or hard constraints <span class="citation" data-cites="Park2004StaMeca Cimini2019StaPhy">(e.g., Park and Newman 2004; Cimini et al. 2019)</span>. Under hard constraints, every network with a non-zero probability exactly satisfies the constraints on its structure. This is in contrast with soft constraints, which require that networks satisfy them on average (i.e. many networks with a non-zero probability do not have the exact structure set by the constraints). Maximum entropy graph models are helpful because they can provide probability distributions for many network properties, by measuring the structure of all adjacency matrices with a non-zero probability. However, we consider that our approach based on simulated annealing is more flexible and more computationally efficient. Indeed, many measures of food-web structure are hard to translate into mathematical constraints. Moreover, because food webs are directed networks with self-loops, it makes the mathematical derivation of maximum entropy graph models difficult. We believe that identifying heuristically what really constrains the topology of food webs is a useful first step before attempting to derive the mathematical formulation of a maximum entropy graph model adapted to food webs.</p>
            <h2 id="applications">Applications</h2>
            <p>Our method and results could be used for different purposes. First, they could be used as first-order approximations of network structure when only state variables are known. This could prove useful when predicting network structure at large spatial scales, where few ecological information is known at that scale. Second, they could be used as informative priors in Bayesian analyses of the structure of ecological networks <span class="citation" data-cites="Cirtwill2019QuaFrac">(e.g., Cirtwill et al. 2019)</span>. Third, they could be used to make better predictions of pairwise species interactions by constraining the space of feasible networks, as discussed in <span class="citation" data-cites="Strydom2021RoaPre">Strydom et al. (2021)</span>. Finally, they could be used as alternative null models of ecological networks to better understand ecological mechanisms driving food-web structure. In that case, our model might need to be slightly adapted to give a probability distribution of Boolean networks (in contrast with point estimates of maximum entropy networks).</p>
            <h2 id="conclusion">Conclusion</h2>
            <p>One of the biggest challenges in using the principle of maximum entropy is to identify the set of state variables that best reproduce empirical data. We found that the numbers of preys and predators for each species are important state variables for the prediction of maximum entropy networks. However, our predictions overestimated some measures of network structure, especially the maximum trophic level and network diameter. Therefore, we should continue playing the ecological detective to find these other topological constraints that would improve the predictions of our MaxEnt network models.</p>
            <h1 id="acknowledgments">Acknowledgments</h1>
            <p>We acknowledge that this study was conducted on land within the traditional unceded territory of the Saint Lawrence Iroquoian, Anishinabewaki, Mohawk, Huron-Wendat, and Omàmiwininiwak nations. This work was supported by the Institute for Data Valorisation (IVADO) and the Natural Sciences and Engineering Research Council of Canada (NSERC) Collaborative Research and Training Experience (CREATE) program, through the Computational Biodiversity Science and Services (BIOS<span class="math inline"><sup>2</sup></span>) program.</p>
            <h1 class="unnumbered" id="references">References</h1>
            <div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
            <div id="ref-Albert2002StaMec" class="csl-entry" role="doc-biblioentry">
            Albert, R., and A. L. Barabasi. 2002. <span>“Statistical Mechanics of Complex Networks.”</span> <em>Reviews of Modern Physics</em> 74 (1): 47–97. <a href="https://doi.org/10.1103/RevModPhys.74.47">https://doi.org/10.1103/RevModPhys.74.47</a>.
            </div>
            <div id="ref-Banville2021ManJla" class="csl-entry" role="doc-biblioentry">
            Banville, Francis, Steve Vissault, and Timothée Poisot. 2021. <span>“Mangal.jl and EcologicalNetworks.jl: Two Complementary Packages for Analyzing Ecological Networks in Julia.”</span> <em>Journal of Open Source Software</em> 6 (61): 2721. <a href="https://doi.org/10.21105/joss.02721">https://doi.org/10.21105/joss.02721</a>.
            </div>
            <div id="ref-Bascompte2003NesAssa" class="csl-entry" role="doc-biblioentry">
            Bascompte, J., P. Jordano, C. J. Melian, and J. M. Olesen. 2003. <span>“The Nested Assembly of Plant-Animal Mutualistic Networks.”</span> <em>Proceedings of the National Academy of Sciences of the United States of America</em> 100 (16): 9383–87. <a href="https://doi.org/10.1073/pnas.1633576100">https://doi.org/10.1073/pnas.1633576100</a>.
            </div>
            <div id="ref-Bastolla2009ArcMut" class="csl-entry" role="doc-biblioentry">
            Bastolla, Ugo, Miguel A. Fortuna, Alberto Pascual-Garcia, Antonio Ferrera, Bartolo Luque, and Jordi Bascompte. 2009. <span>“The Architecture of Mutualistic Networks Minimizes Competition and Increases Biodiversity.”</span> <em>Nature</em> 458 (7241): 1018–U91. <a href="https://doi.org/10.1038/nature07950">https://doi.org/10.1038/nature07950</a>.
            </div>
            <div id="ref-Beck2009GenInf" class="csl-entry" role="doc-biblioentry">
            Beck, Christian. 2009. <span>“Generalised Information and Entropy Measures in Physics.”</span> <em>Contemporary Physics</em> 50 (4): 495–510. <a href="https://doi.org/10.1080/00107510902823517">https://doi.org/10.1080/00107510902823517</a>.
            </div>
            <div id="ref-Cimini2019StaPhy" class="csl-entry" role="doc-biblioentry">
            Cimini, Giulio, Tiziano Squartini, Fabio Saracco, Diego Garlaschelli, Andrea Gabrielli, and Guido Caldarelli. 2019. <span>“The Statistical Physics of Real-World Networks.”</span> <em>Nature Reviews Physics</em> 1 (1): 58–71. <a href="https://doi.org/10.1038/s42254-018-0002-6">https://doi.org/10.1038/s42254-018-0002-6</a>.
            </div>
            <div id="ref-Cirtwill2019QuaFrac" class="csl-entry" role="doc-biblioentry">
            Cirtwill, Alyssa R., Anna Eklof, Tomas Roslin, Kate Wootton, and Dominique Gravel. 2019. <span>“A Quantitative Framework for Investigating the Reliability of Empirical Network Construction.”</span> <em>Methods in Ecology and Evolution</em> 10 (6): 902–11. <a href="https://doi.org/10.1111/2041-210X.13180">https://doi.org/10.1111/2041-210X.13180</a>.
            </div>
            <div id="ref-Cohen2003EcoComa" class="csl-entry" role="doc-biblioentry">
            Cohen, Joel E., Tomas Jonsson, and Stephen R. Carpenter. 2003. <span>“Ecological Community Description Using the Food Web, Species Abundance, and Body Size.”</span> <em>Proceedings of the National Academy of Sciences</em> 100 (4): 1781–86. <a href="https://doi.org/10.1073/pnas.232715699">https://doi.org/10.1073/pnas.232715699</a>.
            </div>
            <div id="ref-Delmas2019AnaEco" class="csl-entry" role="doc-biblioentry">
            Delmas, Eva, Mathilde Besson, Marie Hélène Brice, Laura A. Burkle, Giulio V. Dalla Riva, Marie Josée Fortin, Dominique Gravel, et al. 2019. <span>“Analysing Ecological Networks of Species Interactions.”</span> <em>Biological Reviews</em>. <a href="https://doi.org/10.1111/brv.12433">https://doi.org/10.1111/brv.12433</a>.
            </div>
            <div id="ref-Dunne2002NetStrb" class="csl-entry" role="doc-biblioentry">
            Dunne, Jennifer A., Richard J. Williams, and Neo D. Martinez. 2002. <span>“Network Structure and Biodiversity Loss in Food Webs: Robustness Increases with Connectance.”</span> <em>Ecology Letters</em> 5 (4): 558–67. <a href="https://doi.org/10.1046/j.1461-0248.2002.00354.x">https://doi.org/10.1046/j.1461-0248.2002.00354.x</a>.
            </div>
            <div id="ref-Dunning2017JumMod" class="csl-entry" role="doc-biblioentry">
            Dunning, Iain, Joey Huchette, and Miles Lubin. 2017. <span>“JuMP: A Modeling Language for Mathematical Optimization.”</span> <em>SIAM Review</em> 59 (2): 295–320. <a href="https://doi.org/10.1137/15M1020575">https://doi.org/10.1137/15M1020575</a>.
            </div>
            <div id="ref-Fortuna2006HabLos" class="csl-entry" role="doc-biblioentry">
            Fortuna, M. A., and J. Bascompte. 2006. <span>“Habitat Loss and the Structure of Plant-Animal Mutualistic Networks.”</span> <em>Ecology Letters</em> 9 (3): 278–83. <a href="https://doi.org/10.1111/j.1461-0248.2005.00868.x">https://doi.org/10.1111/j.1461-0248.2005.00868.x</a>.
            </div>
            <div id="ref-Fortuna2010NesMod" class="csl-entry" role="doc-biblioentry">
            Fortuna, M. A., Daniel B. Stouffer, Jens M. Olesen, Pedro Jordano, David Mouillot, Boris R. Krasnov, Robert Poulin, and Jordi Bascompte. 2010. <span>“Nestedness Versus Modularity in Ecological Networks: Two Sides of the Same Coin?”</span> <em>Journal of Animal Ecology</em> 79 (4): 811–17. <a href="https://doi.org/10.1111/j.1365-2656.2010.01688.x">https://doi.org/10.1111/j.1365-2656.2010.01688.x</a>.
            </div>
            <div id="ref-Frank2011SimDera" class="csl-entry" role="doc-biblioentry">
            Frank, S. A., and E. Smith. 2011. <span>“A Simple Derivation and Classification of Common Probability Distributions Based on Information Symmetry and Measurement Scale.”</span> <em>Journal of Evolutionary Biology</em> 24 (3): 469–84. <a href="https://doi.org/10.1111/j.1420-9101.2010.02204.x">https://doi.org/10.1111/j.1420-9101.2010.02204.x</a>.
            </div>
            <div id="ref-Gomez2011FunConb" class="csl-entry" role="doc-biblioentry">
            Gómez, José M., Francisco Perfectti, and Pedro Jordano. 2011. <span>“The Functional Consequences of Mutualistic Network Architecture.”</span> <em>PLOS ONE</em> 6 (1): e16143. <a href="https://doi.org/10.1371/journal.pone.0016143">https://doi.org/10.1371/journal.pone.0016143</a>.
            </div>
            <div id="ref-Harremoes2001MaxEnt" class="csl-entry" role="doc-biblioentry">
            Harremoës, Peter, and Flemming Topsøe. 2001. <span>“Maximum Entropy Fundamentals.”</span> <em>Entropy</em> 3 (3): 191–226. <a href="https://doi.org/10.3390/e3030191">https://doi.org/10.3390/e3030191</a>.
            </div>
            <div id="ref-Harte2014MaxInf" class="csl-entry" role="doc-biblioentry">
            Harte, J., and Erica A. Newman. 2014. <span>“Maximum Information Entropy: A Foundation for Ecological Theory.”</span> <em>Trends in Ecology &amp; Evolution</em> 29 (7): 384–89. <a href="https://doi.org/10.1016/j.tree.2014.04.009">https://doi.org/10.1016/j.tree.2014.04.009</a>.
            </div>
            <div id="ref-Harte2008MaxEnt" class="csl-entry" role="doc-biblioentry">
            Harte, J., T. Zillio, E. Conlisk, and A. B. Smith. 2008. <span>“Maximum Entropy and the State-Variable Approach to Macroecology.”</span> <em>Ecology</em> 89 (10): 2700–2711. <a href="https://doi.org/10.1890/07-1369.1">https://doi.org/10.1890/07-1369.1</a>.
            </div>
            <div id="ref-vanderHoorn2018SpaMaxa" class="csl-entry" role="doc-biblioentry">
            Hoorn, Pim van der, Gabor Lippner, and Dmitri Krioukov. 2018. <span>“Sparse Maximum-Entropy Random Graphs with a Given Power-Law Degree Distribution.”</span> <em>Journal of Statistical Physics</em> 173 (3): 806–44. <a href="https://doi.org/10.1007/s10955-017-1887-7">https://doi.org/10.1007/s10955-017-1887-7</a>.
            </div>
            <div id="ref-Hortal2015SevSho" class="csl-entry" role="doc-biblioentry">
            Hortal, Joaquín, Francesco de Bello, José Alexandre F. Diniz-Filho, Thomas M. Lewinsohn, Jorge M. Lobo, and Richard J. Ladle. 2015. <span>“Seven Shortfalls That Beset Large-Scale Knowledge of Biodiversity.”</span> <em>Annual Review of Ecology, Evolution, and Systematics</em> 46 (1): 523–49. <a href="https://doi.org/10.1146/annurev-ecolsys-112414-054400">https://doi.org/10.1146/annurev-ecolsys-112414-054400</a>.
            </div>
            <div id="ref-Jaynes1957InfThe" class="csl-entry" role="doc-biblioentry">
            Jaynes, E. T. 1957a. <span>“Information Theory and Statistical Mechanics.”</span> <em>Physical Review</em> 106 (4): 620–30. <a href="https://doi.org/10.1103/PhysRev.106.620">https://doi.org/10.1103/PhysRev.106.620</a>.
            </div>
            <div id="ref-Jaynes1957InfThea" class="csl-entry" role="doc-biblioentry">
            ———. 1957b. <span>“Information Theory and Statistical Mechanics. II.”</span> <em>Physical Review</em> 108 (2): 171–90. <a href="https://doi.org/10.1103/PhysRev.108.171">https://doi.org/10.1103/PhysRev.108.171</a>.
            </div>
            <div id="ref-Khinchin2013MatFou" class="csl-entry" role="doc-biblioentry">
            Khinchin, A. Ya. 2013. <em>Mathematical Foundations of Information Theory</em>. Courier Corporation.
            </div>
            <div id="ref-MacDonald2020RevLin" class="csl-entry" role="doc-biblioentry">
            MacDonald, Arthur Andrew Meahan, Francis Banville, and Timothée Poisot. 2020. <span>“Revisiting the Links-Species Scaling Relationship in Food Webs.”</span> <em>Patterns</em> 0 (0). <a href="https://doi.org/10.1016/j.patter.2020.100079">https://doi.org/10.1016/j.patter.2020.100079</a>.
            </div>
            <div id="ref-Martyushev2006MaxEnt" class="csl-entry" role="doc-biblioentry">
            Martyushev, L. M., and V. D. Seleznev. 2006. <span>“Maximum Entropy Production Principle in Physics, Chemistry and Biology.”</span> <em>Physics Reports-Review Section of Physics Letters</em> 426 (1): 1–45. <a href="https://doi.org/10.1016/j.physrep.2005.12.001">https://doi.org/10.1016/j.physrep.2005.12.001</a>.
            </div>
            <div id="ref-Milo2002NetMot" class="csl-entry" role="doc-biblioentry">
            Milo, R., S. Shen-Orr, S. Itzkovitz, N. Kashtan, D. Chklovskii, and U. Alon. 2002. <span>“Network Motifs: Simple Building Blocks of Complex Networks.”</span> <em>Science</em> 298 (5594): 824–27. <a href="https://doi.org/10.1126/science.298.5594.824">https://doi.org/10.1126/science.298.5594.824</a>.
            </div>
            <div id="ref-Park2004StaMeca" class="csl-entry" role="doc-biblioentry">
            Park, Juyong, and M. E. J. Newman. 2004. <span>“Statistical Mechanics of Networks.”</span> <em>Physical Review E</em> 70 (6): 066117. <a href="https://doi.org/10.1103/PhysRevE.70.066117">https://doi.org/10.1103/PhysRevE.70.066117</a>.
            </div>
            <div id="ref-Pascual2006EcoNeta" class="csl-entry" role="doc-biblioentry">
            Pascual, Department of Ecology and Evolutionary Biology Mercedes, and Visiting Professor Jennifer A. Dunne. 2006. <em>Ecological Networks: Linking Structure to Dynamics in Food Webs</em>. Oxford University Press, USA.
            </div>
            <div id="ref-Phillips2006MaxEnta" class="csl-entry" role="doc-biblioentry">
            Phillips, Steven J., Robert P. Anderson, and Robert E. Schapire. 2006. <span>“Maximum Entropy Modeling of Species Geographic Distributions.”</span> <em>Ecological Modelling</em> 190 (3): 231–59. <a href="https://doi.org/10.1016/j.ecolmodel.2005.03.026">https://doi.org/10.1016/j.ecolmodel.2005.03.026</a>.
            </div>
            <div id="ref-Pielou1975EcoDiv" class="csl-entry" role="doc-biblioentry">
            Pielou, Evelyn C. 1975. <span>“Ecological Diversity.”</span> In. 574.524018 P5.
            </div>
            <div id="ref-Poisot2016ManMakb" class="csl-entry" role="doc-biblioentry">
            Poisot, Timothee, Benjamin Baiser, Jennifer A. Dunne, Sonia Kefi, Francois Massol, Nicolas Mouquet, Tamara N. Romanuk, Daniel B. Stouffer, Spencer A. Wood, and Dominique Gravel. 2016. <span>“Mangal - Making Ecological Network Analysis Simple.”</span> <em>Ecography</em> 39 (4): 384–90. <a href="https://doi.org/10.1111/ecog.00976">https://doi.org/10.1111/ecog.00976</a>.
            </div>
            <div id="ref-Poisot2014WheEcoa" class="csl-entry" role="doc-biblioentry">
            Poisot, Timothée, and Dominique Gravel. 2014. <span>“When Is an Ecological Network Complex? Connectance Drives Degree Distribution and Emerging Network Properties.”</span> <em>PeerJ</em> 2: e251. <a href="https://doi.org/10.7717/peerj.251">https://doi.org/10.7717/peerj.251</a>.
            </div>
            <div id="ref-Pomeranz2018DatInf" class="csl-entry" role="doc-biblioentry">
            Pomeranz, Justin Page, Ross M. Thompson, Timothée Poisot, Jon S. Harding, and Justin P. F. Pomeranz. 2018. <span>“Data from: Inferring Predator-Prey Interactions in Food Webs.”</span> Dryad. <a href="https://doi.org/10.5061/DRYAD.K59M37F">https://doi.org/10.5061/DRYAD.K59M37F</a>.
            </div>
            <div id="ref-Shannon1948MatThe" class="csl-entry" role="doc-biblioentry">
            Shannon, C. E. 1948. <span>“A Mathematical Theory of Communication.”</span> <em>The Bell System Technical Journal</em> 27 (3): 379–423. <a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">https://doi.org/10.1002/j.1538-7305.1948.tb01338.x</a>.
            </div>
            <div id="ref-Staniczenko2013GhoNes" class="csl-entry" role="doc-biblioentry">
            Staniczenko, Phillip P. A., Jason C. Kopp, and Stefano Allesina. 2013. <span>“The Ghost of Nestedness in Ecological Networks.”</span> <em>Nature Communications</em> 4 (1): 1391. <a href="https://doi.org/10.1038/ncomms2422">https://doi.org/10.1038/ncomms2422</a>.
            </div>
            <div id="ref-Stock2021OptTra" class="csl-entry" role="doc-biblioentry">
            Stock, Michiel, Timothée Poisot, and Bernard De Baets. 2021. <span>“Optimal Transportation Theory for Species Interaction Networks.”</span> <em>Ecology and Evolution</em> 11 (9): 3841–55. <a href="https://doi.org/10.1002/ece3.7254">https://doi.org/10.1002/ece3.7254</a>.
            </div>
            <div id="ref-Stouffer2011ComInc" class="csl-entry" role="doc-biblioentry">
            Stouffer, Daniel B., and Jordi Bascompte. 2011. <span>“Compartmentalization Increases Food-Web Persistence.”</span> <em>Proceedings of the National Academy of Sciences</em> 108 (9): 3648–52. <a href="https://doi.org/10.1073/pnas.1014353108">https://doi.org/10.1073/pnas.1014353108</a>.
            </div>
            <div id="ref-Stouffer2007EviExi" class="csl-entry" role="doc-biblioentry">
            Stouffer, Daniel B., Juan Camacho, Wenxin Jiang, and Luis A. Nunes Amaral. 2007. <span>“Evidence for the Existence of a Robust Pattern of Prey Selection in Food Webs.”</span> <em>Proceedings of the Royal Society B-Biological Sciences</em> 274 (1621): 1931–40. <a href="https://doi.org/10.1098/rspb.2007.0571">https://doi.org/10.1098/rspb.2007.0571</a>.
            </div>
            <div id="ref-Strydom2021RoaPre" class="csl-entry" role="doc-biblioentry">
            Strydom, Tanya, Michael D. Catchen, Francis Banville, Dominique Caron, Gabriel Dansereau, Philippe Desjardins-Proulx, Norma R. Forero-Muñoz, et al. 2021. <span>“A Roadmap Towards Predicting Species Interaction Networks (across Space and Time).”</span> <em>Philosophical Transactions of the Royal Society B: Biological Sciences</em> 376 (1837): 20210063. <a href="https://doi.org/10.1098/rstb.2021.0063">https://doi.org/10.1098/rstb.2021.0063</a>.
            </div>
            <div id="ref-Strydom2021SvdEnt" class="csl-entry" role="doc-biblioentry">
            Strydom, Tanya, Giulio V. Dalla Riva, and Timothee Poisot. 2021. <span>“SVD Entropy Reveals the High Complexity of Ecological Networks.”</span> <em>Frontiers in Ecology and Evolution</em> 9: 623141. <a href="https://doi.org/10.3389/fevo.2021.623141">https://doi.org/10.3389/fevo.2021.623141</a>.
            </div>
            <div id="ref-Williams2011BioMet" class="csl-entry" role="doc-biblioentry">
            Williams, Richard J. 2011. <span>“Biology, Methodology or Chance? The Degree Distributions of Bipartite Ecological Networks.”</span> <em>PLOS ONE</em> 6 (3): e17645. <a href="https://doi.org/10.1371/journal.pone.0017645">https://doi.org/10.1371/journal.pone.0017645</a>.
            </div>
            <div id="ref-Williams2000SimRul" class="csl-entry" role="doc-biblioentry">
            Williams, Richard J., and Neo D. Martinez. 2000. <span>“Simple Rules Yield Complex Food Webs.”</span> <em>Nature</em> 404 (6774): 180–83. <a href="https://doi.org/10.1038/35004572">https://doi.org/10.1038/35004572</a>.
            </div>
            </div>
        </article>
    </main>

    <footer>
        <div class="container">
            <h2>Affiliations</h2> 
            <sup>1</sup>&nbsp;Université de Montréal; <sup>2</sup>&nbsp;Université de Sherbrooke; <sup>3</sup>&nbsp;Quebec Centre for Biodiversity Science
            <br />
            
        </div>
    </footer>
    
</body>
</html>